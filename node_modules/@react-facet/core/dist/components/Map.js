"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.Map = void 0;
const react_1 = __importDefault(require("react"));
const useFacetMemo_1 = require("../hooks/useFacetMemo");
const useFacetUnwrap_1 = require("../hooks/useFacetUnwrap");
const useFacetMap_1 = require("../hooks/useFacetMap");
const types_1 = require("../types");
const Map = ({ array, children, equalityCheck }) => {
    var _a;
    const countValue = (_a = (0, useFacetUnwrap_1.useFacetUnwrap)((0, useFacetMap_1.useFacetMap)((array) => array.length, [], [array]))) !== null && _a !== void 0 ? _a : 0;
    return (react_1.default.createElement(react_1.default.Fragment, null, times((index) => equalityCheck !== undefined ? (react_1.default.createElement(MapChildMemo, { key: index, arrayFacet: array, index: index, equalityCheck: equalityCheck, children: children })) : (react_1.default.createElement(MapChild, { key: index, arrayFacet: array, index: index, children: children })), countValue !== types_1.NO_VALUE ? countValue : 0)));
};
exports.Map = Map;
const MapChildMemo = ({ arrayFacet, index, children, equalityCheck }) => {
    const childFacet = (0, useFacetMemo_1.useFacetMemo)((array) => {
        if (index < array.length)
            return array[index];
        return types_1.NO_VALUE;
    }, [index], [arrayFacet], equalityCheck);
    return children(childFacet, index);
};
const MapChild = ({ arrayFacet, index, children }) => {
    const childFacet = (0, useFacetMap_1.useFacetMap)((array) => {
        if (index < array.length)
            return array[index];
        return types_1.NO_VALUE;
    }, [index], [arrayFacet]);
    return children(childFacet, index);
};
const times = (fn, n) => {
    const result = [];
    for (let index = 0; index < n; index++) {
        result.push(fn(index));
    }
    return result;
};
//# sourceMappingURL=Map.js.map