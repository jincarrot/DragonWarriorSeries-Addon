"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useSetStyle = void 0;
const react_1 = require("react");
const mapKeys = (x, callback) => {
    const a = [];
    let b;
    for (b in x) {
        a.push(callback(b));
    }
    return a;
};
function useSetStyle(style, ref) {
    const gamefaceStyleRef = (0, react_1.useRef)(null);
    (0, react_1.useLayoutEffect)(() => {
        if (style === undefined)
            return;
        const element = ref.current;
        if (element === null)
            return;
        gamefaceStyleRef.current = element.style;
        if (gamefaceStyleRef.current === null)
            return;
        // Casting elementStyle because of issues with matching the CSS Style type and the FacetCSSStyleDeclaration
        const elementStyle = gamefaceStyleRef.current;
        const unsubscribes = mapKeys(style, (key) => {
            let cache = null;
            const value = style[key];
            if (value === undefined)
                return;
            if (typeof value === 'string' || typeof value === 'number') {
                if (cache !== value) {
                    elementStyle[key] = value;
                    cache = value;
                }
            }
            else {
                const property = value;
                return property.observe((value) => {
                    elementStyle[key] = value;
                });
            }
        });
        return () => {
            unsubscribes.forEach((unsubscribe) => {
                unsubscribe === null || unsubscribe === void 0 ? void 0 : unsubscribe();
            });
        };
    }, [style, ref]);
}
exports.useSetStyle = useSetStyle;
//# sourceMappingURL=useSetStyle.js.map